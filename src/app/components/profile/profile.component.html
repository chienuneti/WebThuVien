<div class="user-profile-container">
  <!-- Sidebar b√™n tr√°i -->
  <aside class="sidebar">
    <div class="user-avatar">
      <div class="avatar-circle">
        <span>{{ userProfile?.name?.charAt(0) || 'U' }}</span>
      </div>
      <h2 class="user-name">{{ userProfile?.name || 'ƒêang t·∫£i...' }}</h2>
      <p class="user-email">{{ userProfile?.email }}</p>
    </div>

    <nav class="sidebar-nav">
      <button 
        class="nav-item" 
        [class.active]="activeSection === 'info'"
        (click)="setActiveSection('info')">
        <span class="icon">üë§</span>
        <span>Th√¥ng tin c√° nh√¢n</span>
      </button>

      <button 
        class="nav-item" 
        [class.active]="activeSection === 'saved'"
        (click)="setActiveSection('saved')">
        <span class="icon">üìö</span>
        <span>S√°ch ƒë√£ l∆∞u</span>
        <span class="badge">{{ savedBooks.length }}</span>
      </button>

      <button 
        class="nav-item" 
        [class.active]="activeSection === 'reading'"
        (click)="setActiveSection('reading')">
        <span class="icon">üìñ</span>
        <span>S√°ch ƒëang ƒë·ªçc</span>
        <span class="badge">{{ currentlyReading.length }}</span>
      </button>

      <button 
        class="nav-item" 
        [class.active]="activeSection === 'upload-history'"
        (click)="setActiveSection('upload-history')">
        <span class="icon">‚¨ÜÔ∏è</span>
        <span>L·ªãch s·ª≠ ƒë·∫©y s√°ch</span>
      </button>

      <button 
        class="nav-item" 
        [class.active]="activeSection === 'download-history'"
        (click)="setActiveSection('download-history')">
        <span class="icon">‚¨áÔ∏è</span>
        <span>L·ªãch s·ª≠ t·∫£i s√°ch</span>
      </button>
      
      <button 
        class="nav-item" 
        [class.active]="activeSection === 'logout'"
        (click)="logout()">
        <span class="icon">‚èª</span>
        <span>ƒêƒÉng xu·∫•t </span>
      </button>
    </nav>
  </aside>

  <!-- N·ªôi dung ch√≠nh b√™n ph·∫£i -->
  <main class="main-content">
    <!-- Loading state -->
    <div *ngIf="loading" class="loading">
      <div class="spinner"></div>
      <p>ƒêang t·∫£i d·ªØ li·ªáu...</p>
    </div>

    <!-- Error state -->
    <div *ngIf="error" class="error-message">
      <p>{{ error }}</p>
    </div>

     <!-- Th√¥ng tin c√° nh√¢n -->
    <section *ngIf="activeSection === 'info' && !loading" class="content-section">
      <h1 class="section-title">Th√¥ng tin c√° nh√¢n</h1>
      
      <div class="info-card">
        <form (ngSubmit)="updateProfile()" #profileForm="ngForm">
          <div class="info-row">
            <span class="info-label">H·ªç v√† t√™n:</span>
            <span class="info-value">
              <input 
                type="text" 
                class="form-input"
                name="fullName" 
                [(ngModel)]="editProfile.name"/>
                <!-- {{userProfile?.name}} -->
            </span>
          </div>
          
          <div class="info-row">
            <span class="info-label">Email:</span>
            <span class="info-value readonly">{{ userProfile?.email }}</span>
          </div>
          
          <div class="info-row">
            <span class="info-label">L·ªõp:</span>
            <span class="info-value readonly">{{ userProfile?.class }}</span>
          </div>
          
          <div class="info-row">
            <span class="info-label">S·ªë ƒëi·ªán tho·∫°i:</span>
            <span class="info-value">
              <input 
                type="tel" 
                class="form-input"
                name="phoneNumber" 
                [(ngModel)]="editProfile.phoneNumber"
                pattern="[0-9]{10,11}"
                placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i"/>
            </span>
          </div>

          <div class="form-actions">
            <button 
              type="submit" 
              class="btn btn-primary"
              [disabled]="!profileForm.valid || isUpdating">
              {{ isUpdating ? 'ƒêang c·∫≠p nh·∫≠t...' : 'C·∫≠p nh·∫≠t th√¥ng tin' }}
            </button>
          </div>
        </form>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-number">{{ savedBooks.length }}</div>
          <div class="stat-label">S√°ch ƒë√£ l∆∞u</div>
        </div>
        
        <div class="stat-card">
          <div class="stat-number">{{ currentlyReading.length }}</div>
          <div class="stat-label">ƒêang ƒë·ªçc</div>
        </div>
        
        <div class="stat-card">
          <div class="stat-number">{{ uploadHistory.length }}</div>
          <div class="stat-label">ƒê√£ ƒë·∫©y l√™n</div>
        </div>
        
        <div class="stat-card">
          <div class="stat-number">{{ downloadHistory.length }}</div>
          <div class="stat-label">ƒê√£ t·∫£i xu·ªëng</div>
        </div>
      </div>
    </section>
    <!-- S√°ch ƒë√£ l∆∞u -->
    <section *ngIf="activeSection === 'saved'" class="content-section">
      <h1 class="section-title">S√°ch ƒë√£ l∆∞u</h1>
      
      <div *ngIf="savedBooks.length === 0" class="empty-state">
        <p>üìö B·∫°n ch∆∞a l∆∞u s√°ch n√†o</p>
      </div>

      <div class="books-grid">
        <div *ngFor="let book of savedBooks" class="book-card" [routerLink]="['/library/book', book.documentId]">
          <img 
            [src]="book.coverPath || 'assets/default-book-cover.jpg'" 
            [alt]="book.title"
            class="book-cover">
          
          <div class="book-info">
            <h3 class="book-title">{{ book.title }}</h3>
            <!-- <p class="book-author">{{ book.author }}</p> -->
            
            <div class="book-actions">
              <button class="btn btn-primary" (click)="continueReading(book.documentId)">
                ƒê·ªçc ngay
              </button>
              <button class="btn btn-danger" (click)="removeSavedBook(book.documentId)">
                X√≥a
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- S√°ch ƒëang ƒë·ªçc -->
    <section *ngIf="activeSection === 'reading'" class="content-section">
      <h1 class="section-title">S√°ch ƒëang ƒë·ªçc</h1>
      
      <div *ngIf="currentlyReading.length === 0" class="empty-state">
        <p>üìñ B·∫°n ch∆∞a ƒë·ªçc s√°ch n√†o</p>
      </div>

      <div class="books-grid">
        <div *ngFor="let book of currentlyReading" class="book-card"[routerLink]="['/library/book', book.documentId]">
          <img 
            [src]="book.coverPath || 'assets/default-book-cover.jpg'" 
            [alt]="book.title"
            class="book-cover">
          
          <div class="book-info">
            <h3 class="book-title">{{ book.title }}</h3>
            <!-- <p class="book-author">{{ book.author }}</p> -->
            
            <div class="progress-bar">
              <div class="progress-fill" [style.width.%]="book.progress || 0"></div>
            </div>
            <p class="progress-text">{{ book.progress || 0 }}% ho√†n th√†nh</p>
            
            <div class="book-actions">
              <button class="btn btn-primary" (click)="continueReading(book.documentId)">
                Ti·∫øp t·ª•c ƒë·ªçc
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- L·ªãch s·ª≠ ƒë·∫©y s√°ch -->
    <section *ngIf="activeSection === 'upload-history'" class="content-section">
      <h1 class="section-title">L·ªãch s·ª≠ ƒë·∫©y s√°ch l√™n</h1>
      
      <div *ngIf="uploadHistory.length === 0" class="empty-state">
        <p>‚¨ÜÔ∏è B·∫°n ch∆∞a ƒë·∫©y s√°ch n√†o l√™n th∆∞ vi·ªán</p>
      </div>

      <div class="history-list">
        <div *ngFor="let item of uploadHistory" class="history-item">
          <div class="history-icon upload">‚¨ÜÔ∏è</div>
          <div class="history-details">
            <h3 class="history-title">{{ item.bookTitle }}</h3>
            <!-- <p class="history-author">{{ item.bookAuthor }}</p> -->
            <p class="history-date">{{ formatDate(item.date) }}</p>
          </div>
        </div>
      </div>
    </section>

    <!-- L·ªãch s·ª≠ t·∫£i s√°ch -->
    <section *ngIf="activeSection === 'download-history'" class="content-section">
      <h1 class="section-title">L·ªãch s·ª≠ t·∫£i s√°ch</h1>
      
      <div *ngIf="downloadHistory.length === 0" class="empty-state">
        <p>‚¨áÔ∏è B·∫°n ch∆∞a t·∫£i s√°ch n√†o</p>
      </div>

      <div class="history-list">
        <div *ngFor="let item of downloadHistory" class="history-item">
          <div class="history-icon download">‚¨áÔ∏è</div>
          <div class="history-details">
            <h3 class="history-title">{{ item.bookTitle }}</h3>
            <p class="history-author">{{ item.bookAuthor }}</p>
            <p class="history-date">{{ formatDate(item.date) }}</p>
          </div>
        </div>
      </div>
    </section>
  </main>
</div>